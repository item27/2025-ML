# Вопрос №1.08

> Как и зачем делать one-hot encoding? Можно ли это делать функцией pandas.get\_dummies? Чем one-hot отличается от binary-encoding?

**Ответ:**

**Что такое One-Hot Encoding**

**One-Hot Encoding** - это способ преобразования категориальных признаков в числовые,

при котором **каждое уникальное значение категории превращается в отдельный бинарный столбец** (признак).

_Цвет = (красный, синий, красный, зеленый)_

↓ One-hot

| is\_red | is\_blue | is\_green |
| ------- | -------- | --------- |
| 1       | 0        | 0         |
| 0       | 1        | 0         |
| 1       | 0        | 0         |
| 0       | 0        | 1         |

Как раз таки это и можно сделать через `pandas.get_dummies()`

```python
import pandas as pd
df = pd.DataFrame({'color': ['red', 'blue', 'green']})
pd.get_dummies(df, columns=['color'])
```

**Зачем это нужно:**

* Многие модели (линейная регрессия, SVM, нейросети) **не умеют работать с текстовыми или категориальными признаками**;
* **Избегает ложного порядка** между категориями, который создаётся при простом числовом кодировании (`Label Encoding`);
* Делает признаки **взаимно независимыми** - каждая категория кодируется отдельно.

**Недостатки One-Hot Encoding**

* При большом количестве категорий (например, тысячах значений) создаётся **очень много столбцов** → растёт размерность и время обучения;
* Может вызвать **разреженность данных** (sparse matrix), особенно при малом количестве наблюдений.

**Binary Encoding - альтернатива One-Hot**

**Binary Encoding** решает проблему большого количества столбцов:

* Каждой категории присваивается уникальный номер;
* Этот номер переводится в **двоичное представление**;
* Каждый бит становится отдельным бинарным признаком.

Категории: \[A, B, C, D] → Номера: \[1, 2, 3, 4] → Бинарно: \[01, 10, 11, 100] → Признаки:

| bit1 | bit2 | bit3 |
| ---- | ---- | ---- |
| 0    | 0    | 1    |
| 0    | 1    | 0    |
| 0    | 1    | 1    |
| 1    | 0    | 0    |

**Сравнение One-Hot и Binary Encoding**

| Характеристика       | **One-Hot Encoding**              | **Binary Encoding**                 |
| -------------------- | --------------------------------- | ----------------------------------- |
| Количество признаков | = числу категорий                 | ≈ log₂(число категорий)             |
| Интерпретируемость   | Простая и понятная                | Менее очевидна                      |
| Производительность   | Медленнее при множестве категорий | Быстрее при большом числе категорий |
| Когда использовать   | До \~100 категорий                | Когда категорий очень много (1000+) |
