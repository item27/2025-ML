# Вопрос №3.02

> Модель `k-means`

Модель k-means — алгоритм кластеризации, который делит набор точек на $$k$$ кластеров так, чтобы минимизировать сумму квадратов расстояний точек до центров своих кластеров.

## Цель (функция потерь)

$$
J = \sum_{i=1}^{k} \sum_{x \in C_i} |x - \mu_i|^2
$$

где $$C_i$$ — множество точек кластера $$i$$, а $$\mu_i$$ — его центр (среднее).

## Алгоритм (Lloyd, базовый)

1. Инициализация: выбрать $$k$$ начальных центров $$\mu_1,\dots,\mu_k$$ (обычно k-means++).
2.  Шаг присвоения: для каждой точки $$x_j$$ присвоить её кластер

    $$
    x_j \mapsto \arg\min_{i} |x_j - \mu_i|^2.
    $$
3.  Шаг обновления: для каждого кластера пересчитать центр

    $$
    \mu_i = \frac{1}{|C_i|}\sum_{x \in C_i} x.
    $$
4. Повторять шаги 2–3 пока центры не перестанут существенно меняться или пока не достигнут максимум итераций.

## Свойства и сложность

* Итеративно уменьшает $$J$$ и сходится к локальному минимума.
* Время одной итерации: $$O(n k d)$$ (n — число точек, d — число признаков).
* Чувствителен к начальной инициализации и к масштабу признаков.

## Ограничения и предположения

* Предполагает кластеры примерно сферической формы в евклидовом смысле и схожего размера.
* Плохо работает на вытянутых, неравномерных или перекрывающихся кластерах.
* Чувствителен к выбросам (они смещают центры).

## Практические рекомендации

* Масштабировать признаки (стандартизация или нормализация).
* Использовать k-means++ для инициализации.
* Запускать несколько стартов (n\_init) и выбирать лучшее по $$J$$.
* Для больших наборов данных использовать Mini-Batch k-means.
* Выбирать $$k$$ с помощью метода локтя (elbow), силуэта или gap statistic.
  * Силуэт для точки $$i$$: $$s(i)=\frac{b(i)-a(i)}{\max(a(i),b(i))}$$, где $$a(i)$$ — среднее расстояние до своих, $$b(i)$$ — минимальное среднее расстояние до других кластеров.

## Варианты / альтернативы

* Mini-Batch k-means — для больших данных.
* k-medoids / PAM — устойчивее к выбросам.
* Для категориальных данных используют k-modes или смешанные подходы.

## Короткая шпаргалка для сдачи

* Цель: минимизировать внутри-кластерную сумму квадратов.
* Основные формулы: присвоение $$\arg\min |x-\mu_i|^2$$, центр $$\mu_i=\frac{1}{|C_i|}\sum x$$.
* Важные приёмы: масштабирование, k-means++, несколько стартов, проверка $$k$$ (elbow/silhouette).
