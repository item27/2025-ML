# Вопрос №6.02

> Что такое [ряд Фурье](https://ru.wikipedia.org/wiki/%D0%A0%D1%8F%D0%B4_%D0%A4%D1%83%D1%80%D1%8C%D0%B5)? Как работает дискретное преобразование Фурье?\
> Вот неплохие [иллюстрации](https://proglib.io/p/fourier-transform) по преобразованию

### Что такое ряд Фурье

**Идея:** любой **периодический** сигнал можно представить как сумму простых “чистых тонов” — синусоид с разными частотами, амплитудами и фазами. Эти частоты — **гармоники**: $$f_0, 2f_0, 3f_0, \dots$$ где $$f_0 = 1/T$$ и $$T$$ — период.

Классическая запись: $$x(t)=\frac{a_0}{2}+\sum_{n=1}^{\infty}\Big(a_n\cos(2\pi n f_0 t)+b_n\sin(2\pi n f_0 t)\Big)$$

* $$a_n, b_n$$ — коэффициенты, показывают “сколько” каждой гармоники нужно.
* Чем “резче” сигнал (например, прямоугольная волна), тем больше высоких гармоник требуется.

**Как это понимать на слух/в аудио:**

* синусоида одной частоты — чистый тон;
* сложный звук = смесь многих частот;
* ряд Фурье — способ формально разложить периодический звук на такие “частотные кирпичики”.

***

### Как работает дискретное преобразование Фурье

В компьютере у нас не $$x(t)$$, а набор отсчётов: $$x[0], x[1], \dots, x[N-1]$$, полученных с частотой дискретизации $$f_s$$.

**DFT** берёт $$N$$ отсчётов во времени и выдаёт $$N$$ “частотных коэффициентов”: $$X[k]=\sum_{n=0}^{N-1} x[n];e^{-j,2\pi kn/N},\quad k=0,\dots,N-1$$

**Смысл:**

* DFT сравнивает сигнал $$x[n]$$ с набором базисных “тональностей” (комплексных синусоид) на частотах-ячейках.
* Если в сигнале сильно присутствует частота, соответствующая ячейке $$k$$, то модуль $$|X[k]|$$ будет большим.

**Какая частота у индекса** $$k$$**:** $$f_k=\frac{k}{N}f_s$$

**Что в итоге лежит в** $$X[k]$$**:**

* $$|X[k]|$$ — “насколько сильно” присутствует частота $$f_k$$ (амплитуда/энергия);
* $$\arg(X[k])$$ — фаза этой компоненты.

**Обратное преобразование** восстанавливает сигнал: $$x[n]=\frac{1}{N}\sum_{k=0}^{N-1} X[k];e^{j,2\pi kn/N}$$

***

### Важные практические моменты (для аудио)

1. **DFT предполагает периодичность окна**: как будто ваш фрагмент длины $$N$$ повторяется по кругу. Если на границах есть разрыв — появляется **спектральное растекание** (leakage).
2. Поэтому часто делают **оконное умножение** перед DFT: $$x_w[n]=x[n]\cdot w[n]$$, чтобы сгладить края.
3. **FFT** — это не другое преобразование, а быстрый алгоритм вычисления DFT (ускоряет с $$O(N^2)$$ до примерно $$O(N\log N)$$).
