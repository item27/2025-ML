# Вопрос №1.13

> Метрики регрессии: mae, mse, (s-)mape

**Ответ:**

Метрики регрессии измеряют, **насколько хорошо модель предсказывает числовые значения**.

Чем **меньше значение метрики**, тем **лучше модель**.

**Mean Absolute Error (MAE)**

$$
MAE = \frac{1}{n} \sum_{i=1}^{n} |y_i - \hat{y_i}|
$$

**Смысл:** средняя величина ошибки в тех же единицах, что и целевая переменная.

**Интерпретация:** “в среднем модель ошибается на X единиц”.

* Проста в понимании.
* Не учитывает, насколько сильно выбиваются отдельные ошибки.

Если реальные цены — (100, 200, 300), а предсказанные — (90, 220, 280),

MAE = (10 + 20 + 20) / 3 = **16.7**.

**Mean Squared Error (MSE)**

$$
MSE = \frac{1}{n} \sum_{i=1}^{n} (y_i - \hat{y_i})^2
$$

**Смысл:** усреднённый квадрат ошибки.

Большие ошибки **штрафуются сильнее**, чем маленькие.

* Подходит, если важно избегать крупных промахов.
* Измеряется в квадрате исходных единиц (труднее интерпретировать).

**Root Mean Squared Error (RMSE)**

$$
RMSE = \sqrt{MSE}
$$

**Смысл:** возвращает ошибку в тех же единицах, что и целевая переменная.

**Интерпретация:** средняя величина отклонения между прогнозом и фактом.

**Mean Absolute Percentage Error (MAPE)**

$$
MAPE = \frac{100\%}{n} \sum_{i=1}^{n} \left|\frac{y_i - \hat{y_i}}{y_i}\right|
$$

**Смысл:** показывает ошибку **в процентах** от фактического значения.

* Удобно для бизнес-интерпретации (“ошибка прогноза — 8%”).
* Не работает, если $$y_i = 0$$; переоценивает ошибки при малых y.

Пример: если прогноз 110 при реальном 100,

ошибка = |100−110|/100 = 10% → MAPE = 10.

**Symmetric MAPE (SMAPE)**

$$
SMAPE = \frac{100\%}{n} \sum_{i=1}^{n} \frac{2|y_i - \hat{y_i}|}{|y_i| + |\hat{y_i}|}
$$

**Смысл:** симметричный вариант MAPE — учитывает как переоценку, так и недооценку.

* Не “взрывается” при $$y_i = 0$$.
* Нормирована в диапазоне (0, 200%).
* Менее интуитивна для интерпретации.

**Дополнительно: R² (коэффициент детерминации)**

$$
R^2 = 1 - \frac{\sum (y_i - \hat{y_i})^2}{\sum (y_i - \bar{y})^2}
$$

Показывает, **какая доля дисперсии данных объясняется моделью**.

* $$R^2 = 1$$ — идеальная модель;
* $$R^2 = 0$$ — не лучше, чем просто среднее;
* $$R^2 < 0$$ — модель хуже среднего.
