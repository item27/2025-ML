# Вопрос №5.05

> Ядро свёртки (фильтр) **одновременно применяется ко всем каналам входа**, а не к одному.

#### Если вход — “изображение” с каналами

Вход имеет форму $$H \times W \times C_{in}$$ (например, RGB: $$C_{in}=3$$).

Тогда **одно ядро** имеет форму $$K_h \times K_w \times C_{in}$$ и в каждой позиции считает сумму по **всем** входным каналам:

$$
y(i,j)=\sum_{u,v,c} x(i+u,j+v,c),w(u,v,c)+b
$$

Результат одного такого ядра — **одна** карта признаков (один выходной канал).

#### Если вход — карты признаков предыдущего слоя

Точно так же: вход предыдущего слоя — это $$H \times W \times C_{in}$$, где $$C_{in}$$ — число карт признаков (каналов). Фильтр снова имеет глубину $$C_{in}$$ и “смотрит” сразу на **все** входные карты признаков.

#### К одному или нескольким картам признаков?

* **Одно ядро** использует **все входные** карты признаков (все $$C_{in}$$ каналов) и создаёт **одну выходную** карту признаков.
* **Несколько ядер** (их $$C_{out}$$) создают **несколько выходных** карт признаков.

Итого: слой с параметром $$C_{out}$$ содержит $$C_{out}$$ фильтров размером $$K_h \times K_w \times C_{in}$$ и выдаёт $$H' \times W' \times C_{out}$$.

{% hint style="warning" %}
Есть исключение — **grouped/depthwise convolution**, где фильтр может работать не по всем каналам, а по группе или по одному каналу. Но “обычная” conv работает по всем входным каналам.
{% endhint %}
