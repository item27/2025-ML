# Вопрос №4.17

> Метрики BLEU (Bilingual Evaluation Understudy), Perplexity, WER (Word Error Rate). Зачем нужны и как считаются

## BLEU

* **Зачем:** оценка качества машинного перевода (и любых seq2seq результатов), сравнивая n-граммы с эталонными переводами.
* **Как считается:**
  1. Для каждого `n = 1..N` (обычно 4) считаем precision совпавших n-грам:
     `p_n = (число совпавших n-грам) / (общее число n-грам в кандидате)`. Совпадения clip’ят по максимуму в референсе.
  2. Вычисляем геометрическое среднее: `exp( Σ w_n log p_n )`, где веса `w_n` часто равны 1/N.
  3. Множим на brevity penalty (штраф за короткие предложения):
     `BP = 1`, если `c > r`; иначе `BP = exp(1 - r/c)`, где `c` — длина кандидата, `r` — длина эталона.
  4. Итог: `BLEU = BP * exp( Σ w_n log p_n )`.
* **Интерпретация:** 0–1 (или 0–100%). Чем выше, тем ближе текст к референсу.

## Perplexity (PPL)

* **Зачем:** измеряет, насколько «уверена» языковая модель на тестовом корпусе. Меньше = лучше.
* **Формула:** `PPL = exp( - (1/M) Σ_{i=1..M} log p(w_i | w_{<i}) )`, где `M` — число токенов. Эквивалентно `PPL = 2^{H}` при логарифмах по 2.
* **Интерпретация:** среднее количество вариантов, между которыми модель «сомневается». Если PPL = 10, модель ведёт себя как будто выбирает слово из 10 равновероятных вариантов.

## WER (Word Error Rate)

* **Зачем:** стандартная метрика для распознавания речи и других систем, где сравнивают последовательности слов.
* **Формула:** `WER = (S + D + I) / N`, где:
  * `S` — количество замен (substitutions),
  * `D` — пропусков (deletions),
  * `I` — вставок (insertions),
  * `N` — количество слов в эталоне.
  Эти значения берут из минимального редакционного расстояния (Levenshtein).
* **Интерпретация:** доля слов, которые модель распознала неверно. 0 = идеально, 1 = каждое слово ошибочно (или больше, если много вставок).

Итого: BLEU — схожесть перевода с эталоном по n-граммам, Perplexity — уверенность LM, WER — доля словарных ошибок в распознавании. Каждая метрика служит своей задаче и имеет конкретную формулу вычисления.
